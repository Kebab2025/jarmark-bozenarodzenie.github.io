<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>Kasa ≈öwiƒÖteczna</title>
<style>
body { font-family: Arial, sans-serif; margin:20px; background:#fafafa; color:#111; }
h1 { text-align:center; }
.grid { display:grid; grid-template-columns:repeat(2,1fr); gap:10px; margin-bottom:20px; }
button { padding:12px; font-size:16px; border-radius:10px; cursor:pointer; border:1px solid #ccc; background:#eee; }
button:hover { background:#ddd; }
#koszyk, #paragon, #paragonKuchnia { background:#f0f0f0; padding:15px; border-radius:10px; margin-bottom:20px; white-space:pre-wrap; }
#platnoscDiv, #komunikatDiv { display:none; position:fixed; top:50%; left:50%; transform:translate(-50%,-50%);
  background:white; padding:20px; border-radius:15px; box-shadow:0 0 15px rgba(0,0,0,0.5); z-index:1001; width:320px; text-align:center; }
#overlay { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:1000; }
#resztaText { margin-top:15px; font-weight:bold; }
.dark { background:#111; color:#eee; }
.dark #koszyk, .dark #paragon, .dark #paragonKuchnia { background:#222; }
#loginDiv { position:fixed; top:50%; left:50%; transform:translate(-50%,-50%);
  background:#fff; padding:20px; border-radius:15px; box-shadow:0 0 15px rgba(0,0,0,0.5);
  width:320px; text-align:center; z-index:2000; }
.notaBtn { margin-left:5px; font-size:14px; padding:4px 8px; }
#modalInput { width: 90%; padding: 5px; margin-top: 10px; margin-bottom: 10px; display:none; }
#szukajProduktow { width:95%; padding:6px; margin-bottom:10px; font-size:16px; border-radius:8px; border:1px solid #ccc; }
</style>
</head>
<body>

<div id="loginDiv">
<h2>üîë Logowanie kasjera</h2>
<input type="text" id="loginUser" placeholder="Login"><br><br>
<input type="password" id="loginPass" placeholder="Has≈Ço"><br><br>
<button onclick="zaloguj()">Zaloguj</button>
</div>

<div id="app" style="display:none;">
<h1>üéÑ Kasa ≈öwiƒÖteczna üéÖ</h1>
<p id="kasjerInfo"></p>
<button onclick="wyloguj()">üö™ Wyloguj</button>
<button onclick="toggleDarkMode()">üåô/‚òÄÔ∏è Tryb</button>
<hr>

<input type="text" id="szukajProduktow" oninput="filtrujProdukty()" placeholder="üîç Wyszukaj produkt...">

<h2>üçî Jedzenie</h2>
<div class="grid" id="jedzenieGrid"></div>

<h2>üç∞ Desery</h2>
<div class="grid" id="deseryGrid"></div>

<h2>ü•§ Napoje</h2>
<div class="grid" id="napojeGrid"></div>

<h2>Koszyk:</h2>
<div id="koszyk">Koszyk jest pusty.</div>

<button onclick="wybierzPlatnosc()">üßæ Wystaw paragon</button>
<button onclick="resetuj()">‚ùå Resetuj</button>
<button onclick="otworzKodPromocyjny()">üéÅ Kod promocyjny</button>

<div id="overlay"></div>

<div id="platnoscDiv">
<h3>Wybierz formƒô p≈Çatno≈õci:</h3>
<select id="platnoscSelect" onchange="aktualizujWalute()">
<option value="PLN">Got√≥wka (PLN)</option>
<option value="USD">USD</option>
<option value="EUR">EUR</option>
<option value="BLIK">BLIK</option>
</select>
<div id="gotowkaInputDiv">
<label>Kwota od klienta: </label>
<input type="number" id="gotowkaInput" min="0" step="0.01">
</div>
<div id="resztaText"></div>
<button onclick="zatwierdzPlatnosc()">Zatwierd≈∫ p≈Çatno≈õƒá</button>
</div>

<div id="komunikatDiv">
<p id="komunikatText"></p>
<input type="text" id="modalInput" placeholder="">
<br>
<button onclick="zatwierdzModal()">OK</button>
</div>

<h2>Potwierdzenie klienta:</h2>
<pre id="paragon"></pre>
<h2>Potwierdzenie kuchni:</h2>
<pre id="paragonKuchnia"></pre>

<br><br><br><br><br><br>

<script>
// Loginy i has≈Ça
const kasjerzy = { "kasjer1":"A1b2C3d4", "kasjer2":"X9y8Z7w6", "kasjer3":"M4n5O6p7" };
let zalogowanyKasjer=null;

// Produkty z rozmiarami
const produkty = {
  "F_m":["Frytki ma≈Çe",8], "F_s":["Frytki ≈õrednie",10], "F_l":["Frytki du≈ºe",12],
  "b":["Burger klasyczny",18], "bk":["Burger Kr√≥lewski",24],
  "pz_m":["Pizza margherita ma≈Ça",20], "pz_l":["Pizza margherita du≈ºa",26],
  "ph_m":["Pizza hawajska ma≈Ça",22], "ph_l":["Pizza hawajska du≈ºa",28],
  "w":["Wata cukrowa",7], "g":["Gofr suchy",10], "gn":["Gofr nutella",14],
  "gb":["Gofr bita ≈õmietana",13], "gbo":["Gofr bita ≈õmietana + owoce",15],
  "l_m":["Lody w ro≈ºku ma≈Çe",6], "l_l":["Lody w ro≈ºku du≈ºe",9],
  "c_m":["GorƒÖca czekolada ma≈Ça",7], "c_l":["GorƒÖca czekolada du≈ºa",9],
  "k":["Kawa",7], "t":["Herbata",6],
  "s":["Sok pomara≈Ñczowy",8], "cola_m":["Cola ma≈Ça",4], "cola_l":["Cola du≈ºa",6]
};
let kategorie = { 
  "jedzenie":["F_m","F_s","F_l","b","bk","pz_m","pz_l","ph_m","ph_l"], 
  "desery":["w","g","gn","gb","gbo","l_m","l_l"], 
  "napoje":["c_m","c_l","k","t","s","cola_m","cola_l"] 
};

let kursy={USD:4.2,EUR:4.7};
let zamowienie={}, notatki={}, numer=1, sumaPLN=0;
let wybranaPlatnosc='', sumaDoZaplaty=0, pokazanoReszte=false;
let rabatPromocyjny=false, modalTyp=null, aktualnyKod=null, aktualnyIndeks=null;

// Generowanie przycisk√≥w produkt√≥w
function generujPrzyciski(){
  for(let kat in kategorie){
    let div=document.getElementById(kat+"Grid");
    div.innerHTML="";
    kategorie[kat].forEach(kod=>{
      let [nazwa,cena]=produkty[kod];
      let btn=document.createElement("button");
      btn.textContent=`${nazwa} (${cena} z≈Ç)`;
      btn.dataset.kod=kod;
      btn.onclick=()=>dodaj(kod);
      div.appendChild(btn);
    });
  }
}
generujPrzyciski();

// Wyszukiwanie produkt√≥w
function filtrujProdukty(){
  let filter=document.getElementById("szukajProduktow").value.toLowerCase();
  for(let kat in kategorie){
    kategorie[kat].forEach(kod=>{
      let btn=document.querySelector(`button[data-kod='${kod}']`);
      btn.style.display=produkty[kod][0].toLowerCase().includes(filter) ? "block" : "none";
    });
  }
}

// Modal
function pokazModal(msg,typ=null,kod=null,indeks=null){
  document.getElementById("komunikatText").textContent=msg;
  document.getElementById("komunikatDiv").style.display='block';
  document.getElementById("overlay").style.display='block';
  modalTyp=typ; aktualnyKod=kod; aktualnyIndeks=indeks;
  let input=document.getElementById("modalInput");
  if(typ){ input.value=""; input.style.display='block'; input.placeholder=(typ==="notatka"?"Wpisz notatkƒô":"Wpisz kod promocyjny"); } 
  else input.style.display='none';
}
function zamknijModal(){ 
  document.getElementById("komunikatDiv").style.display='none'; 
  document.getElementById("overlay").style.display='none'; 
  modalTyp=null; aktualnyKod=null; aktualnyIndeks=null; 
  document.getElementById("modalInput").value=''; 
}
function zatwierdzModal(){
  if(modalTyp==="notatka"){
    notatki[aktualnyKod][aktualnyIndeks] = document.getElementById("modalInput").value;
    aktualizujKoszyk();
    zamknijModal();
  }
  else if(modalTyp==="kod"){
    let val=document.getElementById("modalInput").value.trim().toUpperCase();
    if(val==="PROMO10"){ rabatPromocyjny=true; aktualizujKoszyk(); zamknijModal(); }
    else { document.getElementById("komunikatText").textContent="Niepoprawny kod."; modalTyp="info"; }
  } else { zamknijModal(); }
}

// Logowanie i wylogowanie
function zaloguj(){
  let user=document.getElementById("loginUser").value.trim();
  let pass=document.getElementById("loginPass").value.trim();
  if(kasjerzy[user] && kasjerzy[user]===pass){ 
    zalogowanyKasjer=user; 
    document.getElementById("loginDiv").style.display="none"; 
    document.getElementById("app").style.display="block"; 
    document.getElementById("kasjerInfo").textContent="üë®‚Äçüíº Zalogowany: "+user; 
  } else pokazModal("Nieprawid≈Çowe dane logowania!");
}
function wyloguj(){ zalogowanyKasjer=null; resetuj(); document.getElementById("app").style.display='none'; document.getElementById("loginDiv").style.display='block'; document.getElementById("loginUser").value=''; document.getElementById("loginPass").value=''; }

// Koszyk
function dodaj(kod){ 
  if(!zamowienie[kod]) zamowienie[kod]=0; 
  zamowienie[kod]++; 
  if(!notatki[kod]) notatki[kod]=[]; 
  notatki[kod].push(""); 
  aktualizujKoszyk(); 
}
function dodajNotatke(kod,i){ pokazModal("Dodaj notatkƒô:","notatka",kod,i); }
function aktualizujKoszyk(){
  let tekst="", suma=0;
  for(let kod in zamowienie){
    let [nazwa,cena]=produkty[kod], ilosc=zamowienie[kod];
    suma+=cena*ilosc;
    let notatkiLinie = notatki[kod];
    tekst += `<div><b>${ilosc}x ${nazwa} = ${(cena*ilosc).toFixed(2)} z≈Ç</b></div>`;
    for(let i=0;i<ilosc;i++){
      if(notatkiLinie[i] && notatkiLinie[i].trim()!=="") tekst += `<div>‚Ä¢ Notatka: ${notatkiLinie[i]} <button class="notaBtn" onclick="dodajNotatke('${kod}',${i})">+</button></div>`;
      else tekst += `<div><button class="notaBtn" onclick="dodajNotatke('${kod}',${i})">Dodaj notatkƒô</button></div>`;
    }
  }
  sumaPLN=suma;
  if(rabatPromocyjny){ let r=(suma*0.1).toFixed(2); suma=(suma-r).toFixed(2); tekst+=`<div><b>Rabat promocyjny -10% (-${r} z≈Ç)</b></div>`; }
  if(tekst==="") tekst="Koszyk jest pusty.";
  tekst += `<br><br>`;
  document.getElementById("koszyk").innerHTML=tekst;
}

// Kod promocyjny
function otworzKodPromocyjny(){ pokazModal("Wpisz kod promocyjny:","kod"); }

// P≈Çatno≈õƒá
function wybierzPlatnosc(){
  if(Object.keys(zamowienie).length===0) return pokazModal("Koszyk jest pusty!");
  document.getElementById("platnoscDiv").style.display='block';
  document.getElementById("overlay").style.display='block';
  document.getElementById("gotowkaInputDiv").style.display='block';
  document.getElementById("gotowkaInput").value='';
  document.getElementById("resztaText").textContent='';
  pokazanoReszte=false;
  aktualizujWalute();
}
function aktualizujWalute(){
  let wal=document.getElementById("platnoscSelect").value;
  let kwotaDoZaplaty=sumaPLN;
  if(rabatPromocyjny) kwotaDoZaplaty=(kwotaDoZaplaty*0.9).toFixed(2);
  if(wal==='USD'||wal==='EUR') kwotaDoZaplaty=(kwotaDoZaplaty*1.2/kursy[wal]).toFixed(2);
  document.getElementById("gotowkaInput").placeholder=`min: ${kwotaDoZaplaty} ${wal}`;
}
function zatwierdzPlatnosc(){
  wybranaPlatnosc=document.getElementById("platnoscSelect").value;
  let kwota=parseFloat(document.getElementById("gotowkaInput").value);
  sumaDoZaplaty=sumaPLN;
  if(rabatPromocyjny) sumaDoZaplaty=(sumaDoZaplaty*0.9).toFixed(2);
  if(wybranaPlatnosc==='USD'||wybranaPlatnosc==='EUR') sumaDoZaplaty=(sumaDoZaplaty*1.2/kursy[wybranaPlatnosc]).toFixed(2);
  if(wybranaPlatnosc==='BLIK'){ pokazParagon(); return;}
  if(!pokazanoReszte){
    if(isNaN(kwota)||kwota<sumaDoZaplaty) return pokazModal(`Za ma≈Ça kwota! Minimalnie ${sumaDoZaplaty} ${wybranaPlatnosc}`);
    document.getElementById("resztaText").textContent=`Reszta: ${(kwota-sumaDoZaplaty).toFixed(2)} ${wybranaPlatnosc}`;
    pokazanoReszte=true; return;
  }
  pokazParagon(kwota,(kwota-sumaDoZaplaty).toFixed(2));
}

// Paragon
function pokazParagon(kwota=null,reszta=null){
  let teraz=new Date();
  let godzina=teraz.toLocaleTimeString();
  let linie="********** POTWIERDZENIE **********\n";
  linie+="Godzina: "+godzina+"\n";
  linie+="Kasjer: "+zalogowanyKasjer+"\n";
  linie+="Zam√≥wienie nr #"+numer+"\n";
  linie+="------------------------------------\n";
  for(let kod in zamowienie){
    let [nazwa,cena]=produkty[kod],ilosc=zamowienie[kod];
    linie+=`${ilosc}x ${nazwa} ${cena*ilosc} z≈Ç\n`;
  }
  linie+="------------------------------------\n";
  if(rabatPromocyjny) linie+="Rabat -10%\n";
  linie+="SUMA: "+sumaDoZaplaty+" "+wybranaPlatnosc+"\n";
  if(reszta) linie+="Reszta: "+reszta+" "+wybranaPlatnosc+"\n";
  linie+="************************************\n";
  linie+="Dziƒôkujemy ‚Äì Zapraszamy ponownie!\n";
  document.getElementById("paragon").textContent=linie;

  let linieK="********** KUCHNIA **********\n";
  linieK+="Godzina: "+godzina+"\n";
  linieK+="Zam√≥wienie nr #"+numer+"\n";
  linieK+="------------------------------------\n";
  for(let kod in zamowienie){
    let [nazwa]=produkty[kod],ilosc=zamowienie[kod];
    for(let i=0;i<ilosc;i++){
      linieK+=`${nazwa}`;
      if(notatki[kod][i] && notatki[kod][i].trim()!=="") linieK+=" ["+notatki[kod][i]+"]";
      linieK+="\n";
    }
  }
  linieK+="************************************\n";
  document.getElementById("paragonKuchnia").textContent = linieK;

  numer++; zamowienie={}; notatki={}; rabatPromocyjny=false; aktualizujKoszyk();
  document.getElementById("platnoscDiv").style.display='none'; document.getElementById("overlay").style.display='none';
}

// Reset i tryb
function resetuj(){ zamowienie={}; notatki={}; rabatPromocyjny=false; document.getElementById("paragon").textContent=""; document.getElementById("paragonKuchnia").textContent=""; aktualizujKoszyk(); }
function toggleDarkMode(){ document.body.classList.toggle("dark"); }
</script>
</body>
</html>
