<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>Kasa ≈öwiƒÖteczna PRO</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; background:#fafafa; color:#111; }
  h1 { text-align:center; }
  .grid { display:grid; grid-template-columns:repeat(2,1fr); gap:10px; margin-bottom:20px; }
  button { padding:12px; font-size:16px; border-radius:10px; cursor:pointer; border:1px solid #ccc; background:#eee; }
  button:hover { background:#ddd; }
  #koszyk, #paragon { background:#f0f0f0; padding:15px; border-radius:10px; margin-bottom:20px; }
  #platnoscDiv {
    display:none; position:fixed; top:50%; left:50%; transform:translate(-50%,-50%);
    background:white; padding:20px; border-radius:15px; box-shadow:0 0 15px rgba(0,0,0,0.5); z-index:1001; width:320px; text-align:center;
  }
  #overlay { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:1000; }
  #resztaText { margin-top:15px; font-weight:bold; }
  .dark { background:#111; color:#eee; }
  .dark #koszyk, .dark #paragon { background:#222; }
</style>
</head>
<body>

<h1>üéÑ Kasa ≈öwiƒÖteczna PRO üéÖ</h1>

<!-- Prze≈ÇƒÖcznik motywu -->
<button onclick="toggleDarkMode()">üåô/‚òÄÔ∏è Tryb</button>
<hr>

<h2>üçî Jedzenie</h2>
<div class="grid">
  <button onclick="dodaj('F')">Frytki du≈ºe (12 z≈Ç)</button>
  <button onclick="dodaj('f')">Frytki ma≈Çe (8 z≈Ç)</button>
  <button onclick="dodaj('b')">Burger klasyczny (18 z≈Ç)</button>
  <button onclick="dodaj('bk')">Burger Kr√≥lewski (24 z≈Ç)</button>
  <button onclick="dodaj('pz')">Pizza margherita (26 z≈Ç)</button>
  <button onclick="dodaj('ph')">Pizza hawajska (28 z≈Ç)</button>
</div>

<h2>üç∞ Desery</h2>
<div class="grid">
  <button onclick="dodaj('w')">Wata cukrowa (7 z≈Ç)</button>
  <button onclick="dodaj('g')">Gofr suchy (10 z≈Ç)</button>
  <button onclick="dodaj('gn')">Gofr nutella (14 z≈Ç)</button>
  <button onclick="dodaj('gb')">Gofr bita ≈õmietana (13 z≈Ç)</button>
  <button onclick="dodaj('gbo')">Gofr bita ≈õmietana + owoce (15 z≈Ç)</button>
  <button onclick="dodaj('l')">Lody w ro≈ºku (9 z≈Ç)</button>
</div>

<h2>ü•§ Napoje</h2>
<div class="grid">
  <button onclick="dodaj('c')">GorƒÖca czekolada (9 z≈Ç)</button>
  <button onclick="dodaj('k')">Kawa (7 z≈Ç)</button>
  <button onclick="dodaj('t')">Herbata (6 z≈Ç)</button>
  <button onclick="dodaj('s')">Sok pomara≈Ñczowy (8 z≈Ç)</button>
  <button onclick="dodaj('cola')">Cola (6 z≈Ç)</button>
</div>

<h2>Koszyk:</h2>
<div id="koszyk">Koszyk jest pusty.</div>

<button onclick="wybierzPlatnosc()">üßæ Wystaw paragon</button>
<button onclick="resetuj()">‚ùå Resetuj</button>
<button onclick="kodPromocyjny()">üéÅ Kod promocyjny</button>

<div id="overlay"></div>
<div id="platnoscDiv">
  <h3>Wybierz formƒô p≈Çatno≈õci:</h3>
  <select id="platnoscSelect" onchange="aktualizujWalute()">
    <option value="PLN">Got√≥wka (PLN)</option>
    <option value="USD">USD</option>
    <option value="EUR">EUR</option>
    <option value="BLIK">BLIK</option>
  </select>
  <div id="gotowkaInputDiv">
    <label>Kwota od klienta: </label>
    <input type="number" id="gotowkaInput" min="0" step="0.01">
  </div>
  <div id="resztaText"></div>
  <button onclick="zatwierdzPlatnosc()">Zatwierd≈∫ p≈Çatno≈õƒá</button>
</div>

<h2>Paragon:</h2>
<pre id="paragon"></pre>
<button onclick="drukujParagon()">üñ® Drukuj paragon</button>

<script>
const produkty = {
  "F":["Frytki du≈ºe",12],
  "f":["Frytki ma≈Çe",8],
  "w":["Wata cukrowa",7],
  "c":["GorƒÖca czekolada",9],
  "g":["Gofr suchy",10],
  "gn":["Gofr nutella",14],
  "gb":["Gofr bita ≈õmietana",13],
  "gbo":["Gofr bita ≈õmietana + owoce",15],
  "l":["Lody w ro≈ºku",9],
  "b":["Burger klasyczny",18],
  "bk":["Burger Kr√≥lewski",24],
  "pz":["Pizza margherita",26],
  "ph":["Pizza hawajska",28],
  "k":["Kawa",7],
  "t":["Herbata",6],
  "s":["Sok pomara≈Ñczowy",8],
  "cola":["Cola",6]
};

let kursy={USD:4.2,EUR:4.7};
let zamowienie={}, notatki={}, numer=1, sumaPLN=0;
let wybranaPlatnosc='', sumaDoZaplaty=0, pokazanoReszte=false;
let rabatPromocyjny=false, punktyLojalnosciowe=0;

function dodaj(kod){
  if(!zamowienie[kod]) zamowienie[kod]=0;
  zamowienie[kod]++; if(!notatki[kod]) notatki[kod]=[]; notatki[kod].push("");
  aktualizujKoszyk();
}

function aktualizujKoszyk(){
  let tekst="", suma=0;
  for(let kod in zamowienie){
    let [nazwa,cena]=produkty[kod],ilosc=zamowienie[kod];
    suma+=cena*ilosc;
    let wszystkiePuste=notatki[kod].every(n=>n.trim()==="");
    if(wszystkiePuste) tekst+=`<div>${ilosc}x ${nazwa} = ${cena*ilosc} z≈Ç</div>`;
    else for(let i=0;i<ilosc;i++){
      let linia=`1x ${nazwa} = ${cena} z≈Ç`;
      if(notatki[kod][i].trim()!=="") linia+=` (Notatka: ${notatki[kod][i]})`;
      tekst+=`<div>${linia}</div>`;
    }
    for(let i=0;i<ilosc;i++) tekst+=`<input type="text" placeholder="Notatka" value="${notatki[kod][i]}" oninput="notatki['${kod}'][${i}]=this.value"><br>`;
  }
  sumaPLN=suma;
  if(rabatPromocyjny){let r=(suma*0.1).toFixed(2); suma=(suma-r).toFixed(2); tekst+=`<div><b>Rabat promocyjny -10% (-${r} z≈Ç)</b></div>`;}
  tekst+=`<div><b>Suma: ${suma} z≈Ç</b></div>`;
  tekst+=`<div>üéÅ Punkty lojalno≈õciowe: ${punktyLojalnosciowe}</div>`;
  document.getElementById("koszyk").innerHTML=tekst;
}

function kodPromocyjny(){
  let kod=prompt("Wpisz kod promocyjny:");
  if(kod && kod.trim().toUpperCase()==="PROMO10"){ rabatPromocyjny=true; alert("Kod poprawny! Rabat -10%"); aktualizujKoszyk();}
  else alert("Niepoprawny kod.");
}

function wybierzPlatnosc(){
  if(Object.keys(zamowienie).length===0) return alert("Koszyk jest pusty!");
  document.getElementById("platnoscDiv").style.display='block';
  document.getElementById("overlay").style.display='block';
  document.getElementById("gotowkaInputDiv").style.display='block';
  document.getElementById("gotowkaInput").value='';
  document.getElementById("resztaText").textContent='';
  pokazanoReszte=false; aktualizujWalute();
}

function aktualizujWalute(){
  let wal=document.getElementById("platnoscSelect").value;
  if(wal==='PLN'){document.getElementById("gotowkaInputDiv").style.display='block';}
  else if(wal==='USD'||wal==='EUR'){
    let sumaWal=(sumaPLN*1.2/kursy[wal]).toFixed(2);
    document.getElementById("gotowkaInput").placeholder=`min: ${sumaWal} ${wal}`;
    document.getElementById("gotowkaInputDiv").style.display='block';
  } else document.getElementById("gotowkaInputDiv").style.display='none';
}

function zatwierdzPlatnosc(){
  wybranaPlatnosc=document.getElementById("platnoscSelect").value;
  if(wybranaPlatnosc==='USD'||wybranaPlatnosc==='EUR') sumaDoZaplaty=(sumaPLN*1.2/kursy[wybranaPlatnosc]).toFixed(2);
  else sumaDoZaplaty=sumaPLN;
  if(rabatPromocyjny) sumaDoZaplaty=(sumaDoZaplaty*0.9).toFixed(2);
  let kwota=parseFloat(document.getElementById("gotowkaInput").value);
  if(wybranaPlatnosc==='BLIK'){ pokazParagon(); return;}
  if(isNaN(kwota)||kwota<sumaDoZaplaty) return alert("Za ma≈Ça kwota!");
  if(!pokazanoReszte){document.getElementById("resztaText").textContent=`Reszta: ${(kwota-sumaDoZaplaty).toFixed(2)} ${wybranaPlatnosc}`; pokazanoReszte=true; return;}
  else pokazParagon(kwota,(kwota-sumaDoZaplaty).toFixed(2));
}

function pokazParagon(kwota=null,reszta=null){
  let linie="====================================\n";
  linie+=" üéÑ KASA ≈öWIƒÑTECZNA PRO\n";
  linie+=" Zam√≥wienie nr "+numer+"\n";
  linie+=new Date().toLocaleString()+"\n";
  linie+="------------------------------------\n";
  for(let kod in zamowienie){
    let [nazwa,cena]=produkty[kod],ilosc=zamowienie[kod];
    let puste=notatki[kod].every(n=>n.trim()==="");
    if(puste) linie+=`${ilosc}x ${nazwa} ${cena*ilosc} z≈Ç\n`;
    else for(let i=0;i<ilosc;i++){linie+=`1x ${nazwa} ${cena} z≈Ç`; if(notatki[kod][i].trim()!=="") linie+=` [${notatki[kod][i]}]`; linie+="\n";}
  }
  linie+="------------------------------------\n";
  if(rabatPromocyjny) linie+="Rabat -10%\n";
  if(numer%5===0) { linie+="Bonus: -5% lojalno≈õciowy\n"; sumaDoZaplaty=(sumaDoZaplaty*0.95).toFixed(2);}
  linie+="SUMA: "+sumaDoZaplaty+" "+wybranaPlatnosc+"\n";
  if(reszta) linie+="Reszta: "+reszta+" "+wybranaPlatnosc+"\n";
  linie+="Punkty: "+(++punktyLojalnosciowe)+"\n";
  linie+="====================================\n";
  linie+="üéÅ Zeskanuj QR i odbierz bonus!\n";
  linie+="[QR KOD]\n";
  document.getElementById("paragon").textContent=linie;
  numer++; zamowienie={}; notatki={}; rabatPromocyjny=false; aktualizujKoszyk();
  document.getElementById("platnoscDiv").style.display='none'; document.getElementById("overlay").style.display='none';
}

function resetuj(){zamowienie={};notatki={};rabatPromocyjny=false;document.getElementById("paragon").textContent="";aktualizujKoszyk();}

function drukujParagon(){const p=document.getElementById("paragon").textContent;const w=window.open('','','width=400,height=600');w.document.write('<pre>'+p+'</pre>');w.document.close();w.focus();w.print();w.close();}

function toggleDarkMode(){document.body.classList.toggle("dark");}
</script>

</body>
</html>
