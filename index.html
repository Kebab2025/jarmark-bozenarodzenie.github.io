<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>Kasa ÅšwiÄ…teczna PRO</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; background:#fafafa; color:#111; }
  h1 { text-align:center; }
  .grid { display:grid; grid-template-columns:repeat(2,1fr); gap:10px; margin-bottom:20px; }
  button { padding:12px; font-size:16px; border-radius:10px; cursor:pointer; border:1px solid #ccc; background:#eee; }
  button:hover { background:#ddd; }
  #koszyk, #paragon, #paragonKuchnia { background:#f0f0f0; padding:15px; border-radius:10px; margin-bottom:20px; }
  #platnoscDiv {
    display:none; position:fixed; top:50%; left:50%; transform:translate(-50%,-50%);
    background:white; padding:20px; border-radius:15px; box-shadow:0 0 15px rgba(0,0,0,0.5); z-index:1001; width:320px; text-align:center;
  }
  #overlay { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:1000; }
  #resztaText { margin-top:15px; font-weight:bold; }
  .dark { background:#111; color:#eee; }
  .dark #koszyk, .dark #paragon, .dark #paragonKuchnia { background:#222; }
  #loginDiv {
    position:fixed; top:50%; left:50%; transform:translate(-50%,-50%);
    background:#fff; padding:20px; border-radius:15px; box-shadow:0 0 15px rgba(0,0,0,0.5);
    width:300px; text-align:center; z-index:2000;
  }
</style>
</head>
<body>

<!-- Logowanie -->
<div id="loginDiv">
  <h2>ğŸ”‘ Logowanie kasjera</h2>
  <input type="text" id="loginUser" placeholder="Login"><br><br>
  <input type="password" id="loginPass" placeholder="HasÅ‚o"><br><br>
  <button onclick="zaloguj()">Zaloguj</button>
</div>

<!-- Aplikacja -->
<div id="app" style="display:none;">
<h1>ğŸ„ Kasa ÅšwiÄ…teczna PRO ğŸ…</h1>
<p id="kasjerInfo"></p>
<button onclick="wyloguj()">ğŸšª Wyloguj</button>
<button onclick="toggleDarkMode()">ğŸŒ™/â˜€ï¸ Tryb</button>
<hr>

<h2>ğŸ” Jedzenie</h2>
<div class="grid">
  <button onclick="dodaj('F')">Frytki duÅ¼e (12 zÅ‚)</button>
  <button onclick="dodaj('f')">Frytki maÅ‚e (8 zÅ‚)</button>
  <button onclick="dodaj('b')">Burger klasyczny (18 zÅ‚)</button>
  <button onclick="dodaj('bk')">Burger KrÃ³lewski (24 zÅ‚)</button>
  <button onclick="dodaj('pz')">Pizza margherita (26 zÅ‚)</button>
  <button onclick="dodaj('ph')">Pizza hawajska (28 zÅ‚)</button>
</div>

<h2>ğŸ° Desery</h2>
<div class="grid">
  <button onclick="dodaj('w')">Wata cukrowa (7 zÅ‚)</button>
  <button onclick="dodaj('g')">Gofr suchy (10 zÅ‚)</button>
  <button onclick="dodaj('gn')">Gofr nutella (14 zÅ‚)</button>
  <button onclick="dodaj('gb')">Gofr bita Å›mietana (13 zÅ‚)</button>
  <button onclick="dodaj('gbo')">Gofr bita Å›mietana + owoce (15 zÅ‚)</button>
  <button onclick="dodaj('l')">Lody w roÅ¼ku (9 zÅ‚)</button>
</div>

<h2>ğŸ¥¤ Napoje</h2>
<div class="grid">
  <button onclick="dodaj('c')">GorÄ…ca czekolada (9 zÅ‚)</button>
  <button onclick="dodaj('k')">Kawa (7 zÅ‚)</button>
  <button onclick="dodaj('t')">Herbata (6 zÅ‚)</button>
  <button onclick="dodaj('s')">Sok pomaraÅ„czowy (8 zÅ‚)</button>
  <button onclick="dodaj('cola')">Cola (6 zÅ‚)</button>
</div>

<h2>Koszyk:</h2>
<div id="koszyk">Koszyk jest pusty.</div>

<button onclick="wybierzPlatnosc()">ğŸ§¾ Wystaw paragon</button>
<button onclick="resetuj()">âŒ Resetuj</button>
<button onclick="kodPromocyjny()">ğŸ Kod promocyjny</button>

<div id="overlay"></div>
<div id="platnoscDiv">
  <h3>Wybierz formÄ™ pÅ‚atnoÅ›ci:</h3>
  <select id="platnoscSelect" onchange="aktualizujWalute()">
    <option value="PLN">GotÃ³wka (PLN)</option>
    <option value="USD">USD</option>
    <option value="EUR">EUR</option>
    <option value="BLIK">BLIK</option>
  </select>
  <div id="gotowkaInputDiv">
    <label>Kwota od klienta: </label>
    <input type="number" id="gotowkaInput" min="0" step="0.01" oninput="pokazReszteNaZywo()">
  </div>
  <div id="resztaText"></div>
  <button onclick="zatwierdzPlatnosc()">ZatwierdÅº pÅ‚atnoÅ›Ä‡</button>
</div>

<h2>Paragon klienta:</h2>
<pre id="paragon"></pre>

<h2>Paragon kuchni:</h2>
<pre id="paragonKuchnia"></pre>

<script>
// ---- Kasjerzy ----
const kasjerzy = { "kasjer1":"haslo1", "kasjer2":"haslo2", "kasjer3":"haslo3" };
let zalogowanyKasjer=null;

// Logowanie
function zaloguj(){
  let user=document.getElementById("loginUser").value.trim();
  let pass=document.getElementById("loginPass").value.trim();
  if(kasjerzy[user] && kasjerzy[user]===pass){
    zalogowanyKasjer=user;
    document.getElementById("loginDiv").style.display="none";
    document.getElementById("app").style.display="block";
    document.getElementById("kasjerInfo").textContent="ğŸ‘¨â€ğŸ’¼ Zalogowany: "+user;
  } else { alert("NieprawidÅ‚owe dane logowania!"); }
}

// Wylogowanie
function wyloguj(){
  zalogowanyKasjer=null;
  resetuj();
  document.getElementById("app").style.display="none";
  document.getElementById("loginDiv").style.display="block";
  document.getElementById("loginUser").value="";
  document.getElementById("loginPass").value="";
}

// ---- Produkty ----
const produkty = {
  "F":["Frytki duÅ¼e",12], "f":["Frytki maÅ‚e",8], "w":["Wata cukrowa",7],
  "c":["GorÄ…ca czekolada",9], "g":["Gofr suchy",10], "gn":["Gofr nutella",14],
  "gb":["Gofr bita Å›mietana",13], "gbo":["Gofr bita Å›mietana + owoce",15],
  "l":["Lody w roÅ¼ku",9], "b":["Burger klasyczny",18], "bk":["Burger KrÃ³lewski",24],
  "pz":["Pizza margherita",26], "ph":["Pizza hawajska",28], "k":["Kawa",7],
  "t":["Herbata",6], "s":["Sok pomaraÅ„czowy",8], "cola":["Cola",6]
};
let kursy={USD:4.2,EUR:4.7};
let zamowienie={}, notatki={}, numer=1, sumaPLN=0;
let wybranaPlatnosc='', sumaDoZaplaty=0, pokazanoReszte=false;
let rabatPromocyjny=false, punktyLojalnosciowe=0;

// ---- Koszyk ----
function dodaj(kod){
  if(!zamowienie[kod]) zamowienie[kod]=0;
  zamowienie[kod]++;
  if(!notatki[kod]) notatki[kod]=[];
  notatki[kod].push("");
  aktualizujKoszyk();
}

function aktualizujKoszyk(){
  let tekst="", suma=0;
  for(let kod in zamowienie){
    let [nazwa,cena]=produkty[kod],ilosc=zamowienie[kod];
    suma+=cena*ilosc;
    let wszystkiePuste=notatki[kod].every(n=>n.trim()==="");
    if(wszystkiePuste) tekst+=`<div>${ilosc}x ${nazwa} = ${cena*ilosc} zÅ‚</div>`;
    else for(let i=0;i<ilosc;i++){
      let linia=`1x ${nazwa} = ${cena} zÅ‚`;
      if(notatki[kod][i].trim()!=="") linia+=` (Notatka: ${notatki[kod][i]})`;
      tekst+=`<div>${linia}</div>`;
    }
    for(let i=0;i<ilosc;i++) tekst+=`<input type="text" placeholder="Notatka" value="${notatki[kod][i]}" oninput="notatki['${kod}'][${i}]=this.value"><br>`;
  }
  sumaPLN=suma;
  if(rabatPromocyjny){let r=(suma*0.1).toFixed(2); suma=(suma-r).toFixed(2); tekst+=`<div><b>Rabat promocyjny -10% (-${r} zÅ‚)</b></div>`;}
  tekst+=`<div><b>Suma: ${suma} zÅ‚</b></div>`;
  tekst+=`<div>ğŸ Punkty lojalnoÅ›ciowe: ${punktyLojalnosciowe}</div>`;
  document.getElementById("koszyk").innerHTML=tekst;
}

// ---- Promocje ----
function kodPromocyjny(){
  let kod=prompt("Wpisz kod promocyjny:");
  if(kod && kod.trim().toUpperCase()==="PROMO10"){ rabatPromocyjny=true; alert("Kod poprawny! Rabat -10%"); aktualizujKoszyk();}
  else alert("Niepoprawny kod.");
}

// ---- PÅ‚atnoÅ›ci ----
function wybierzPlatnosc(){
  if(Object.keys(zamowienie).length===0) return alert("Koszyk jest pusty!");
  document.getElementById("platnoscDiv").style.display='block';
  document.getElementById("overlay").style.display='block';
  document.getElementById("gotowkaInputDiv").style.display='block';
  document.getElementById("gotowkaInput").value='';
  document.getElementById("resztaText").textContent='';
  pokazanoReszte=false; aktualizujWalute();
}

function aktualizujWalute(){
  let wal=document.getElementById("platnoscSelect").value;
  if(wal==='PLN'){document.getElementById("gotowkaInputDiv").style.display='block';}
  else if(wal==='USD'||wal==='EUR'){
    let sumaWal=(sumaPLN*1.2/kursy[wal]).toFixed(2);
    document.getElementById("gotowkaInput").placeholder=`min: ${sumaWal} ${wal}`;
    document.getElementById("gotowkaInputDiv").style.display='block';
  } else document.getElementById("gotowkaInputDiv").style.display='none';
}

function pokazReszteNaZywo(){
  let kwota=parseFloat(document.getElementById("gotowkaInput").value);
  if(isNaN(kwota)) return document.getElementById("resztaText").textContent="";
  let doZaplaty=sumaPLN;
  if(rabatPromocyjny) doZaplaty=(doZaplaty*0.9).toFixed(2);
  let reszta=(kwota-doZaplaty).toFixed(2);
  document.getElementById("resztaText").textContent=reszta>=0 ? `Reszta: ${reszta} PLN` : `Brakuje: ${Math.abs(reszta)} PLN`;
}

function zatwierdzPlatnosc(){
  wybranaPlatnosc=document.getElementById("platnoscSelect").value;
  sumaDoZaplaty=sumaPLN;
  if(rabatPromocyjny) sumaDoZaplaty=(sumaDoZaplaty*0.9).toFixed(2);
  let kwota=parseFloat(document.getElementById("gotowkaInput").value);
  if(wybranaPlatnosc==='BLIK'){ pokazParagon(); return;}
  if(isNaN(kwota)||kwota<sumaDoZaplaty) return alert("Za maÅ‚a kwota!");
  pokazParagon(kwota,(kwota-sumaDoZaplaty).toFixed(2));
}

// ---- Paragon klienta i kuchni ----
function pokazParagon(kwota=null,reszta=null){
  let linie="====================================\n";
  linie+=" ğŸ„ KASA ÅšWIÄ„TECZNA PRO\n";
  linie+=" Kasjer: "+zalogowanyKasjer+"\n";
  linie+=" ZamÃ³wienie nr "+numer+"\n";
  linie+=new Date().toLocaleString()+"\n";
  linie+="------------------------------------\n";
  for(let kod in zamowienie){
    let [nazwa,cena]=produkty[kod],ilosc=zamowienie[kod];
    let puste=notatki[kod].every(n=>n.trim()==="");
    if(puste) linie+=`${ilosc}x ${nazwa} ${cena*ilosc} zÅ‚\n`;
    else for(let i=0;i<ilosc;i++){linie+=`1x ${nazwa} ${cena} zÅ‚`; if(notatki[kod][i].trim()!=="") linie+=` [${notatki[kod][i]}]`; linie+="\n";}
  }
  linie+="------------------------------------\n";
  if(rabatPromocyjny) linie+="Rabat -10%\n";
  if(numer%5===0) { linie+="Bonus: -5% lojalnoÅ›ciowy\n"; sumaDoZaplaty=(sumaDoZaplaty*0.95).toFixed(2);}
  linie+="SUMA: "+sumaDoZaplaty+" "+wybranaPlatnosc+"\n";
  if(reszta) linie+="Reszta: "+reszta+" "+wybranaPlatnosc+"\n";
  linie+="Punkty: "+(++punktyLojalnosciowe)+"\n";
  linie+="====================================\n";
  linie+="ğŸ Zeskanuj QR i odbierz bonus!\n";
  linie+="[QR KOD]\n";
  document.getElementById("paragon").textContent=linie;

  // Paragon kuchni
  let linieKuchnia="===== KASA ÅšWIÄ„TECZNA PRO (KUCHNIA) =====\n";
  linieKuchnia+="ZamÃ³wienie nr "+(numer)+"\n";
  linieKuchnia+=new Date().toLocaleString()+"\n";
  linieKuchnia+="------------------------------------\n";
  for(let kod in zamowienie){
    let [nazwa]=produkty[kod],ilosc=zamowienie[kod];
    let puste=notatki[kod].every(n=>n.trim()==="");
    if(puste) linieKuchnia += `${ilosc}x ${nazwa}\n`;
    else for(let i=0;i<ilosc;i++){
      linieKuchnia += `1x ${nazwa}`;
      if(notatki[kod][i].trim()!=="") linieKuchnia += ` [${notatki[kod][i]}]`;
      linieKuchnia += "\n";
    }
  }
  linieKuchnia+="====================================\n";
  document.getElementById("paragonKuchnia").textContent=linieKuchnia;

  numer++; zamowienie={}; notatki={}; rabatPromocyjny=false; aktualizujKoszyk();
  document.getElementById("platnoscDiv").style.display='none'; document.getElementById("overlay").style.display='none';
}

// ---- Inne ----
function resetuj(){zamowienie={};notatki={};rabatPromocyjny=false;document.getElementById("paragon").textContent="";document.getElementById("paragonKuchnia").textContent="";aktualizujKoszyk();}
function toggleDarkMode(){document.body.classList.toggle("dark");}
</script>

</body>
</html>
